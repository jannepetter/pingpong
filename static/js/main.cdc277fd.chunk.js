(this.webpackJsonppingpong=this.webpackJsonppingpong||[]).push([[0],{120:function(e,t,n){},121:function(e,t,n){},123:function(e,t,n){},147:function(e,t){},149:function(e,t){},160:function(e,t){},162:function(e,t){},187:function(e,t){},189:function(e,t){},190:function(e,t){},195:function(e,t){},197:function(e,t){},216:function(e,t){},228:function(e,t){},231:function(e,t){},235:function(e,t,n){},236:function(e,t,n){},237:function(e,t,n){"use strict";n.r(t);var i,a=n(3),r=n.n(a),c=n(115),s=n.n(c),o=(n(120),n(11)),h=(n(121),n(15)),u=n.n(h),d=n(28),l=1600,f={width:l,height:l*(2/3)},y={x:f.width/2,y:f.height/2,size:f.height/40,dx:f.width/100,dy:f.height/100},g={x:f.width/30,y:f.height/2.5,width:f.width/40,height:f.height/5.5,speed:16,dy:0},p={x:f.width-f.width/20,y:f.height/2.5,width:f.width/40,height:f.height/5.5,speed:16,dy:0},b=!1,w=function(){b=!1,!1},j=function(e,t){Math.abs(e.y+e.height/2-f.height/2)<6?e.dy=0:e.y+e.height/2>f.height/2?e.dy=-1*t:e.y+e.height/2<f.height/2&&(e.dy=t)},x=function(e){var t=0;e&&(t=p.speed/3);var n=function(e,t){var n=Math.abs(e.y-(t.y+t.height/2)),i=Math.min(Math.abs(e.dy)+1,t.speed),a=Math.abs(e.dx),r=Math.abs(e.dy);return a>8||r>8?t.speed:n<t.height/2?i:t.speed}(y,p)-t,i=y.dx>0?"incoming":"outgoing",a=y.y>p.y+p.height/2?"down":"up";switch(y.y>p.y+p.height/2-p.speed&&y.y<p.y+p.height/2+p.speed?i+"towards":i+a){case"incomingdown":p.dy=n;break;case"incomingup":p.dy=-1*n;break;case"incomingtowards":p.dy=0;break;default:j(p,n)}},m=function(e,t,n){if(n)return Math.abs(e-t);if(!n){var i=e+t;return i>f.height?f.height-(i-f.height):i}},v=function(e,t,n,i){var a=function(e){var t=f.width;return e>t/2?t-(t-e)-(g.x+g.width):t-e-(t-p.x)}(e)/n,r=Math.abs(a*i),c=Math.floor(r/f.height),s=r%f.height;if(0===r)return y.y;if(c%2===0&&i<0)return m(t,s,!0);if(c%2===0&&i>0)return m(t,s,!1);if(c%2===1&&i<0){var o=f.height-t;return m(o,s,!1)}if(c%2===1&&i>0){var h=f.height-t;return m(h,s,!0)}},O=f.width/100,k=f.height/100,S=function(){y.x=f.width/2,y.y=f.height/2,y.dx=O,y.dy=k,g.y=f.height/2.5,p.y=f.height/2.5},M=function(e){e.beginPath(),e.fillStyle="white",e.fillRect(g.x,g.y,g.width,g.height),e.fillRect(p.x,p.y,p.width,p.height)},C=function(e){e.beginPath(),e.arc(y.x,y.y,y.size,0,2*Math.PI),e.fillStyle="red",e.fill()},N=function(e,t){e.clearRect(0,0,t.width,t.height),e.fillStyle="black",e.fillRect(0,0,t.width,t.height)},D=(n(123),n(56)),E=n.n(D),I=n(141),T="https://scoresbackend.herokuapp.com/api/scores/",A=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={params:{name:"pong"}},e.next=3,E.a.get(T,t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,i,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.hash("helvetinkovasalasana",10);case 2:return n=e.sent,i={headers:{id:n}},e.next=6,E.a.post(T,t,i);case 6:return a=e.sent,console.log("postaamassa",a),e.abrupt("return",a.data);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=n(2),R=function(e){var t,n=Object(a.useRef)(),r=e.run?"pause":"continue",c=document.getElementById("kanvaasi"),s=Object(a.useState)(0),h=Object(o.a)(s,2),l=h[0],m=h[1],O=Object(a.useState)(0),k=Object(o.a)(O,2),D=k[0],E=k[1],I=e.difficulty,T=e.setDifficulty,A=e.setUpdate,R=e.setStart,P=e.setRun,F=e.setScores;t="easy"===I?100:"normal"===I?200:600;var L=c.getContext("2d");c.width=f.width,c.height=f.height,L.fillStyle="black",L.fillRect(0,0,c.width,c.height);var U=function(e){switch(e){case"easy":return x(!0);case"normal":return x(!1);case"hard":return function(){var e=p.speed,t=y.dx>0?"incoming":"outgoing";"outgoing"===t&&!0===b&&(b=!1),"incoming"===t&&!1===b&&(i=v(y.x,y.y,y.dx,y.dy),b=!0);var n=i>p.y+p.height/2?"down":"up";switch(i<p.y+p.height/2+p.speed&&i>p.y+p.height/2-p.speed&&(n="towards"),t+n){case"incomingdown":p.dy=e;break;case"incomingup":p.dy=-1*e;break;case"incomingtowards":p.dy=0;break;default:j(p,e)}}();default:return x(!0)}},W=Object(a.useCallback)((function(){N(L,c),M(L),C(L),function(e,t,n,i){e.font="30px Arial",e.fillStyle="white",n&&!t?e.fillText("Paused",f.width/2.2,f.height/4.4):n||t?t&&n&&e.fillText("Get ready!",f.width/2.2,f.height/4.4):(e.fillText("Press start to begin game",f.width/2.6,f.height/4.4),e.fillText("Move paddle up, arrowUp key",f.width/2.6,f.height/3.8),e.fillText("Move paddle down, arrowDown key",f.width/2.6,f.height/3.3),e.fillText("Mobile touchkeys, appear in landscapeview",f.width/2.6,f.height/2.95),e.fillText("Who gets ".concat(i," points first wins"),f.width/2.6,f.height/2.65))}(L,e.run,e.start,10)}),[L,c,e.run,e.start]),J=Object(a.useCallback)((function(e){var t=function(){S(),w(),W()};return e.x<-200?(E(D+1),t(),"computer"):e.x>f.width+200?(m(l+1),t(),"player"):"noscore"}),[D,l,W]),Y=function(e,t){return parseInt(t.score)-parseInt(e.score)},_=Object(a.useCallback)(function(){var e=Object(d.a)(u.a.mark((function e(t,n){var i,a,r,c,s,o,h,d,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&l>D)){e.next=16;break}if(console.log(t,t.length,"tarkistus"),a=parseInt(null===(i=t[t.length-1])||void 0===i?void 0:i.score),r=(1+l-D)*n,!(t.length<10||r>a)){e.next=16;break}return c=window.prompt("New highscore"),s={playername:c,score:r.toString()},(o=[]).push(s),t.forEach((function(e){delete e._id,o.push(e)})),h={gamename:"pong",scores:o.sort((function(e,t){return Y(e,t)})).slice(0,10)},e.next=13,z(h);case 13:d=e.sent,f=d.scores?d.scores:[],F(f);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[D,l,F]),q=Object(a.useCallback)((function(n){var i=function(){setTimeout((function(){A(!0)}),1500)},a=function(){R(!1),P(!1),T("easy"),N(L,c),M(L),C(L),function(e,t,n){e.font="30px Arial",e.fillStyle="white",t>n?e.fillText("You won! Play again?",f.width/2.4,f.height/4.4):n>t&&e.fillText("You lose! Try again?",f.width/2.4,f.height/4.4)}(L,l,D)};switch(n){case"computer":if(D+1>=10){a(),_(e.scores,t);break}i();break;case"player":if(l+1>=10){a(),_(e.scores,t);break}i()}}),[L,c,l,D,A,R,P,T,t,_,e.scores]),G=Object(a.useCallback)((function(){N(L,c),M(L),U(I),g.y+=g.dy,p.y+=p.dy,C(L),y.x+=y.dx,y.y+=y.dy,function(e){g.y<0&&(g.y=0),g.y+g.height>e.height&&(g.y=e.height-g.height),p.y<0&&(p.y=0),p.y+p.height>e.height&&(p.y=e.height-p.height)}(c),function(e){var t=Math.abs(y.dy);y.y>e.height-t&&(y.y=e.height,y.dy*=-1),y.y<t&&(y.y=0,y.dy*=-1)}(c),function(){var e=Math.round(Math.random()*(p.height/20)),t=function(t,n){switch(n.dx>0?"right":"left"){case"right":n.x=t.x-n.size,n.dx*=-1.02;break;case"left":n.x=t.x+t.width+n.size,n.dx*=-1.02}var i=t.height/3;n.y>=t.y-n.size&&n.y<=t.y+i&&(n.dy<=-30?n.dy=-30:n.dy-=2),n.y>=t.y+i&&n.y<=t.y+2*i&&(e%2===0?n.dy+=e:n.dy-=e),n.y>=t.y+2*i&&n.y<=t.y+n.size+3*i&&(n.dy>=30?n.dy=30:n.dy+=2)},n=function(e,t){var n=t.dx>0,i=t.x+t.dx,a=e.x+e.width;return!!(n&&i>=e.x&&i<=a)||!n&&i-t.size<=a&&i>=e.x},i=function(e,t){return t.y>=e.y-t.size&&t.y<=e.y+e.height+t.size};n(g,y)&&i(g,y)&&t(g,y),n(p,y)&&i(p,y)&&t(p,y)}();var e=J(y);"noscore"!==e?(A(!1),q(e)):n.current=requestAnimationFrame(G)}),[c,L,I,A,J,q]);if(Object(a.useEffect)((function(){cancelAnimationFrame(n.current),e.run&&e.start&&e.update&&G()}),[D,l,e.run,e.start,e.update,G,e.difficulty]),e.show)return null;document.addEventListener("keydown",(function(e){"ArrowUp"===e.key&&(g.dy=-1*g.speed),"ArrowDown"===e.key&&(g.dy=g.speed)})),document.addEventListener("keyup",(function(e){"ArrowUp"===e.key&&(g.dy=0),"ArrowDown"===e.key&&(g.dy=0)}));var H=function(e,t){e.cancelable&&e.preventDefault(),g.dy=g.speed*t},$=function(e){e.cancelable&&e.preventDefault(),g.dy=0},K=document.getElementById("ylosnappi"),Q=document.getElementById("alasnappi");return K.addEventListener("touchstart",(function(e){return H(e,-1)}),{passive:!1}),K.addEventListener("touchend",(function(e){return $(e)})),Q.addEventListener("touchstart",(function(e){return H(e,1)}),{passive:!1}),Q.addEventListener("touchend",(function(e){return $(e)})),W(),Object(B.jsxs)("div",{className:"infobar",children:[Object(B.jsxs)("span",{className:"infoitem",children:["player ",l]})," ",Object(B.jsxs)("span",{className:"infoitem",children:["computer   ",D]}),e.start?Object(B.jsx)("button",{className:"infoitem basicButton",onClick:function(){!1!==e.run?!0===e.run&&P(!1):P(!0)},children:r}):null,e.start?Object(B.jsx)("button",{className:"infoitem basicButton",onClick:function(){cancelAnimationFrame(n.current),S(),w(),e.setDifficulty("easy"),W(),R(!1),P(!1),E(0),m(0)},children:"restart"}):Object(B.jsx)("button",{className:"infoitem basicButton",onClick:function(){!1===e.start&&(G(),m(0),E(0),A(!0),P(!0),R(!0))},children:"start"})]})},P=(n(235),function(e){return Object(B.jsx)("div",{className:"optionpanelcontainer",children:Object(B.jsxs)("div",{children:["difficulty:",Object(B.jsx)("input",{disabled:e.start,onChange:function(t){return e.setDifficulty(t.target.value)},name:"jee",type:"radio",id:"radio1",defaultChecked:!0,value:"easy"}),Object(B.jsx)("label",{htmlFor:"radio1",children:"easy"}),Object(B.jsx)("input",{disabled:e.start,onChange:function(t){return e.setDifficulty(t.target.value)},name:"jee",type:"radio",id:"radio2",value:"normal"}),Object(B.jsx)("label",{htmlFor:"radio2",children:"normal"}),Object(B.jsx)("input",{disabled:e.start,onChange:function(t){return e.setDifficulty(t.target.value)},name:"jee",type:"radio",id:"radio3",value:"hard"}),Object(B.jsx)("label",{htmlFor:"radio3",children:"real pro"}),Object(B.jsx)("button",{hidden:e.start,className:"scoreButton",onClick:function(){e.setShow(!e.show)},children:"scores"})]})})}),F=(n(236),function(e){var t=e.scores;return!0===e.show&&t?Object(B.jsxs)("div",{className:"scorePanelContainer",children:[Object(B.jsx)("h3",{children:"Highscores"}),t.map((function(e){return Object(B.jsxs)("div",{className:"scoreInfoDiv",children:[Object(B.jsx)("div",{className:"scoreInfoName",children:e.playername}),Object(B.jsxs)("div",{className:"scoreInfoScore",children:[": ",e.score]})]},e._id)}))]}):null});var L=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)(!1),c=Object(o.a)(r,2),s=c[0],h=c[1],u=Object(a.useState)("easy"),d=Object(o.a)(u,2),l=d[0],f=d[1],y=Object(a.useState)(!1),g=Object(o.a)(y,2),p=g[0],b=g[1],w=Object(a.useState)([]),j=Object(o.a)(w,2),x=j[0],m=j[1],v=Object(a.useState)(!1),O=Object(o.a)(v,2),k=O[0],S=O[1];return Object(a.useEffect)((function(){console.log("loading"),A().then((function(e){var t,n;return m(null===(t=e[0])||void 0===t||null===(n=t.scores)||void 0===n?void 0:n.sort((function(e,t){return function(e,t){return parseInt(t.score)-parseInt(e.score)}(e,t)})))}))}),[]),x||m([]),Object(B.jsxs)("div",{className:"App",children:[Object(B.jsx)(P,{show:k,setShow:S,setDifficulty:f,start:s}),Object(B.jsx)(F,{show:k,scores:x}),Object(B.jsx)(R,{setScores:m,scores:x,show:k,run:n,setRun:i,start:s,setStart:h,difficulty:l,setDifficulty:f,update:p,setUpdate:b})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(B.jsx)(r.a.StrictMode,{children:Object(B.jsx)(L,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[237,1,2]]]);
//# sourceMappingURL=main.cdc277fd.chunk.js.map